{"ast":null,"code":"var _jsxFileName = \"/Users/cgiaramani/AEM-projects/to-do-mine/frontend/src/pages/Root.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { AuthContextProvider } from \"../store/auth-context\";\nimport Dashboard from \"../components/Dashboard\";\nimport Header from \"../components/Header\";\nimport { Outlet, useLoaderData, useSubmit, redirect, useLocation } from \"react-router-dom\";\nimport { getTokenDuration } from '../utils/auth';\nimport { isLoggedIn } from '../utils/auth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Root = () => {\n  _s();\n  const token = useLoaderData();\n  const submit = useSubmit();\n  const [name, setName] = useState(\"\"); // = \"CHRIS\";\n  const location = useLocation();\n  const searchParams = new URLSearchParams(location.search);\n  // let isLogin = searchParams.get('mode') === 'login';\n  // if(isLoggedIn) {\n  //   return redirect(\"/\");\n  // }\n  useEffect(() => {\n    if (isLoggedIn && searchParams.get('mode')) {\n      return redirect(\"/\");\n    }\n    if (!token) {\n      return;\n    }\n    if (token === 'EXPIRED') {\n      submit(null, {\n        action: '/logout',\n        method: 'post'\n      });\n      return;\n    }\n    const tokenDuration = getTokenDuration();\n    console.log(tokenDuration);\n    setTimeout(() => {\n      submit(null, {\n        action: '/logout',\n        method: 'post'\n      });\n      localStorage.removeItem('token');\n      localStorage.removeItem('token-duration');\n      localStorage.removeItem('name');\n    }, tokenDuration);\n    setName(localStorage.getItem('name'));\n  }, [token, submit]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      name: name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Outlet, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n_s(Root, \"TC+JHX94JMVMZdKKd4xyBeXWl9M=\", false, function () {\n  return [useLoaderData, useSubmit, useLocation];\n});\n_c = Root;\nexport default Root;\nvar _c;\n$RefreshReg$(_c, \"Root\");","map":{"version":3,"names":["React","useEffect","useState","DndProvider","HTML5Backend","AuthContextProvider","Dashboard","Header","Outlet","useLoaderData","useSubmit","redirect","useLocation","getTokenDuration","isLoggedIn","Root","token","submit","name","setName","location","searchParams","URLSearchParams","search","get","action","method","tokenDuration","console","log","setTimeout","localStorage","removeItem","getItem"],"sources":["/Users/cgiaramani/AEM-projects/to-do-mine/frontend/src/pages/Root.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { AuthContextProvider } from \"../store/auth-context\";\nimport Dashboard from \"../components/Dashboard\";\nimport Header from \"../components/Header\";\nimport { Outlet, useLoaderData, useSubmit, redirect, useLocation } from \"react-router-dom\";\nimport { getTokenDuration } from '../utils/auth';\nimport { isLoggedIn } from '../utils/auth';\n\nconst Root = () => {\n    const token = useLoaderData();\n    const submit = useSubmit();\n    const [name, setName] = useState(\"\"); // = \"CHRIS\";\n    const location = useLocation();\n    const searchParams = new URLSearchParams(location.search);\n    // let isLogin = searchParams.get('mode') === 'login';\n    // if(isLoggedIn) {\n    //   return redirect(\"/\");\n    // }\n    useEffect(() => {\n        if(isLoggedIn && searchParams.get('mode')) {\n          return redirect(\"/\");\n        }\n        if(!token) {\n            return;\n        }\n\n        if(token === 'EXPIRED') {\n            submit(null, { action: '/logout', method: 'post'});\n            return;\n        }\n\n        const tokenDuration = getTokenDuration();\n        console.log(tokenDuration);\n    \n        setTimeout(() => {\n          submit(null, { action: '/logout', method: 'post' });\n          localStorage.removeItem('token');\n          localStorage.removeItem('token-duration');\n          localStorage.removeItem('name');\n        }, tokenDuration);\n\n        setName(localStorage.getItem('name'));\n    }, [token, submit])\n\n    return (\n        <>\n            <Header name={name}/>\n            <Outlet />\n        </>\n    )\n}\n\nexport default Root"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,WAAW,QAAQ,WAAW;AACvC,SAASC,YAAY,QAAQ,yBAAyB;AACtD,SAASC,mBAAmB,QAAQ,uBAAuB;AAC3D,OAAOC,SAAS,MAAM,yBAAyB;AAC/C,OAAOC,MAAM,MAAM,sBAAsB;AACzC,SAASC,MAAM,EAAEC,aAAa,EAAEC,SAAS,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,kBAAkB;AAC1F,SAASC,gBAAgB,QAAQ,eAAe;AAChD,SAASC,UAAU,QAAQ,eAAe;AAAC;AAAA;AAE3C,MAAMC,IAAI,GAAG,MAAM;EAAA;EACf,MAAMC,KAAK,GAAGP,aAAa,EAAE;EAC7B,MAAMQ,MAAM,GAAGP,SAAS,EAAE;EAC1B,MAAM,CAACQ,IAAI,EAAEC,OAAO,CAAC,GAAGjB,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;EACtC,MAAMkB,QAAQ,GAAGR,WAAW,EAAE;EAC9B,MAAMS,YAAY,GAAG,IAAIC,eAAe,CAACF,QAAQ,CAACG,MAAM,CAAC;EACzD;EACA;EACA;EACA;EACAtB,SAAS,CAAC,MAAM;IACZ,IAAGa,UAAU,IAAIO,YAAY,CAACG,GAAG,CAAC,MAAM,CAAC,EAAE;MACzC,OAAOb,QAAQ,CAAC,GAAG,CAAC;IACtB;IACA,IAAG,CAACK,KAAK,EAAE;MACP;IACJ;IAEA,IAAGA,KAAK,KAAK,SAAS,EAAE;MACpBC,MAAM,CAAC,IAAI,EAAE;QAAEQ,MAAM,EAAE,SAAS;QAAEC,MAAM,EAAE;MAAM,CAAC,CAAC;MAClD;IACJ;IAEA,MAAMC,aAAa,GAAGd,gBAAgB,EAAE;IACxCe,OAAO,CAACC,GAAG,CAACF,aAAa,CAAC;IAE1BG,UAAU,CAAC,MAAM;MACfb,MAAM,CAAC,IAAI,EAAE;QAAEQ,MAAM,EAAE,SAAS;QAAEC,MAAM,EAAE;MAAO,CAAC,CAAC;MACnDK,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC;MAChCD,YAAY,CAACC,UAAU,CAAC,gBAAgB,CAAC;MACzCD,YAAY,CAACC,UAAU,CAAC,MAAM,CAAC;IACjC,CAAC,EAAEL,aAAa,CAAC;IAEjBR,OAAO,CAACY,YAAY,CAACE,OAAO,CAAC,MAAM,CAAC,CAAC;EACzC,CAAC,EAAE,CAACjB,KAAK,EAAEC,MAAM,CAAC,CAAC;EAEnB,oBACI;IAAA,wBACI,QAAC,MAAM;MAAC,IAAI,EAAEC;IAAK;MAAA;MAAA;MAAA;IAAA,QAAE,eACrB,QAAC,MAAM;MAAA;MAAA;MAAA;IAAA,QAAG;EAAA,gBACX;AAEX,CAAC;AAAA,GA1CKH,IAAI;EAAA,QACQN,aAAa,EACZC,SAAS,EAEPE,WAAW;AAAA;AAAA,KAJ1BG,IAAI;AA4CV,eAAeA,IAAI;AAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}